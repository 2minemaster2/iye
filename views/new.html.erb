<form id="new-key-form" class="standalone-form" action="<%= root_path %>create" method="post" onsubmit="disableSubmit(event.target); rememberFileSelection(event.target);">
  <h2>Add new translation:</h2>
  <table>
    <tr>
      <td>File</td>
      <td>
        <select name='key[path_template]'>
          <% app.store.path_templates.each do |path_template| %>
            <option value="<%=path_template%>"><%= path_template.gsub(app.base_path + '/', '') %></option>
          <% end %>
        </select>
      </td>
    </tr>
    <tr>
      <td>Global Key</td>
      <td><input class="global_key" name='key[id]' type="text" size="60" autofocus onfocus="this.value = this.value;" value="<%= ERB::Util.html_escape(String(request.params['key']).gsub(/^\^/, '')) %>"/></td>
    </tr>
    <tr>
      <td>Add Translation</td>
      <td><a href="#" onclick="addTranslation();">+</a></td>
    </tr>
    <tr id="translations">
    </tr>
  </table>
  <p><input class="btn btn-primary" type="submit" value="Create key"></p>
</form>

<%
  array = []
  app.store.locales.each { |locale| array = array + [locale.id] }
%>

<script>
  localStorage.setItem('locales', <%= array %>);
  restoreFileSelection(document.getElementById("new-key-form"));
  $('#new_translation').click(addTranslation());
</script>
